SNR.mat is from commit 41593544de5ca085fa15efc60f09bcdeccaceef2 on 10/17/2016.
I simulated a Gaussian pulse containing varying numbers of photons
reflecting off an object 0.75 m away, with 100 bins of 100 ps each,
being detected by the SPAD.
I fit a Gaussian to the SPAD histogram directly to get a baseline.
I also did pile-up correction with Coates method then fit a Gaussian.
I measured the average error in the reconstruction in mm then took SNR as 10*log10(750/avg error)
I repeated this with 1e4, 1e5, and 1e6 trials.

2/20/17
Gordon: What'd be great to simulate until this meeting is the general benefit of pileup correction for ranging for 3 different scenarios:

1. relatively large laser pulse width, but 0 uncertainty on the spad side

2. infinitely short laser pulse but large temporal spad jitter

3. non-negligible laser pulse width and temporal jitter

The reason for looking at all of these cases is that people may argue along the lines of "just use a better laser or a better spad" and I'd like to have some good arguments in the manuscript for understanding the fundamental benefit of pileup correction in those cases.

New simulations:
I simulated a Gaussian pulse containing varying numbers of photons
reflecting off an object 0.375 m away, with 100 bins of 50 ps each,
being detected by the SPAD.
I fit a Gaussian to the SPAD histogram directly to get a baseline.
I also did pile-up correction with Coates method then fit a Gaussian.
I measured the average error in the reconstruction in mm then took SNR as 10*log10(750/avg error)
I repeated this with 1e4, 1e5, and 1e6 trials.

For 50ps-laser-50ps-jitter-SNR.mat, I used 50ps FWHM for laser and SPAD jitter. 
error-raw-vs-coates-100ps, SNR-raw-vs-coates-100ps

For 0ps-laser-50ps-jitter-SNR.mat, I used 0ps FWHM for laser and 50ps SPAD jitter. 
error-raw-vs-coates-50ps, SNR-raw-vs-coates-50ps

For 50ps-laser-0ps-jitter-SNR.mat, I used 50ps FWHM for laser and 0ps SPAD jitter. 
This is the same as 0ps-laser-50ps-jitter-SNR.mat

Also simulate with 20 ps histogram bins. 50ps FWHM laser and 0ps SPAD jitter.
20ps-bin-50ps-laser-SNR.mat
20ps-bin-error-raw-vs-coates-50ps, 20ps-bin-SNR-raw-vs-coates-50ps


MSE-1e3trials.png (measure Z[:10,:10])
Took average over 5 trials of MSE for raw and Coates methods.
With only the wall, we see the standard 1D response curve.

MSE-fullimg-1e3trials.png (measure Z[:100,:100])
Took average over 5 trials of MSE for raw and Coates methods.
With both the wall and chair, we see a bimodal curve. 
